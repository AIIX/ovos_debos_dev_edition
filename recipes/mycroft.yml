{{- $architecture := or .architecture "arm64" -}}
{{- $firmware_version := or .firmware_version "master" -}}
{{ $suite :=  or .suite "focal" }}
{{- $image := or .image "ovos-dev-edition-rpi4.img" -}}

architecture: {{ $architecture }}

actions:
  - action: overlay
    description: OVOS specific overlay
    source: ../overlays/mycroft

  #- action: download
    #url: https://openvoiceos.com/mycroft-core-setup-aarch64.tar.gz
    #name: mycroft-core
    #filename: mycroft-core-setup-aarch64.tar.gz

  #- action: overlay
    #origin: mycroft-core
    #source: .
    #destination: /var/tmp/mycroft-core-setup-aarch64.tar.gz

  - action: apt
    description: Mycroft runtime dependencies
    packages:
      - pcre2-utils
      - portaudio19-dev
      - jq
      - mpg123
      - libfann-dev
      - flac
      - breeze-icon-theme
      - python3
      - python3-dev
      - python3-setuptools
      - libtool
      - libffi-dev
      - libssl-dev
      - autoconf
      - automake
      - bison
      - swig
      - libglib2.0-dev
      - curl
      - libicu-dev
      - pkg-config
      - libjpeg-dev
      - build-essential
      - pulseaudio
      - pulseaudio-utils
      #- mimic

  - action: run
    description: Set up user account
    chroot: true
    script: ../scripts/02-setup_mycroft_user.sh

  #- action: run
    #description: Install mycroft base software
    #chroot: true
    #script: ../scripts/92-clone-mycroft.sh
